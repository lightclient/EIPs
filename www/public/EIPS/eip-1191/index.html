<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https:&#x2F;&#x2F;eips.ethereum.com&#x2F;minima.css">

        <!-- opengraph -->
        <meta property="og:locale" content="en_US" />
        <meta property="og:url" content="https:&#x2F;&#x2F;eips.ethereum.com" />
        <meta property="og:site_name" content="Ethereum Improvement Proposals" />

        <!-- twitter -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@ethereum" />

        <script type="application/ld+json">
            {
              "@type": "WebSite",
              "url": "https:&#x2F;&#x2F;eips.ethereum.com",
              "name": "Ethereum Improvement Proposals",
              "description": "Description",
              "@context": "https://schema.org"
            }
        </script>

        

        

<title>EIP-1191: Add chain id to mixed-case checksum address encoding</title>
<link rel="canonical" href="https:&#x2F;&#x2F;eips.ethereum.comEIPS&#x2F;eip-1191.md" />
<meta property="og:title" content="EIP-1191: Add chain id to mixed-case checksum address encoding" />
<meta
    name="description"
    content="Details on Ethereum Improvement Proposal 1191 (EIP-1191): Add chain id to mixed-case checksum address encoding"
/>
<meta
    property="og:description"
    content="Details on Ethereum Improvement Proposal 1191 (EIP-1191): Add chain id to mixed-case checksum address encoding"
/>
<meta property="og:url" content="https:&#x2F;&#x2F;eips.ethereum.comEIPS&#x2F;eip-1191.md" />
<meta name="twitter:description" content="Details on Ethereum Improvement Proposal 1191 (EIP 1191): Add chain id to mixed-case checksum address encoding" />

    </head>
    <body>
        <header class="site-header">
            <div class="wrapper">
                <a class="site-title" rel="author" href="https:&#x2F;&#x2F;eips.ethereum.com">Ethereum Improvement Proposals</a>
                <nav class="site-nav">
                    <input type="checkbox" id="nav-trigger" class="nav-trigger" />
                    <label for="nav-trigger">
                        <span class="menu-icon">
                            <svg viewBox="0 0 18 15" width="18px" height="15px">
                                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
                            </svg>
                        </span>
                    </label>

                    <div class="trigger">
                        
                            <a class="page-link" href="&#x2F;all">All</a>
                        
                            <a class="page-link" href="&#x2F;core">Core</a>
                        
                            <a class="page-link" href="&#x2F;networking">Networking</a>
                        
                            <a class="page-link" href="&#x2F;interface">Interface</a>
                        
                            <a class="page-link" href="&#x2F;erc">ERC</a>
                        
                            <a class="page-link" href="&#x2F;meta">Meta</a>
                        
                            <a class="page-link" href="&#x2F;informational">Informational</a>
                        
                    </div>
                </nav>
            </div>
        </header>
        <main class="page-content" aria-label="Content">
            <div class="wrapper">
                
<div class="home">
    <h1 class="page-heading">
        EIP-1191: Add chain id to mixed-case checksum address encoding
        <a href=""><svg role="img" aria-label="Source" xmlns="https://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><title>Source</title><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg></a>
    </h1>
    <table>
        <tr>
            <th>Author</th>
            <td>
    
        
        
            <a href="https://github.com/juli">Juliano Rizzo</a>
        
    
</td>
        </tr>

        
          <tr>
              <th>Discussions-To</th>
              <td><a href="https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;EIPs&#x2F;issues&#x2F;1121">https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;EIPs&#x2F;issues&#x2F;1121</a></td>
          </tr>
        

        <tr>
            <th>Status</th>
            <td>
                Last Call
                
                  <strong>(review ends 2019-11-18)</strong>
                
            </td>
        </tr>

        <tr>
            <th>Type</th>
            <td>Standards Track</td>
        </tr>

        
          <tr>
              <th>Category</th>
              <td>ERC</td>
          </tr>
        

        <tr>
            <th>Created</th>
            <td>2018-03-18</td>
        </tr>

        

        
          <tr>
              <th>Requires</th>
              <td>55, 155</td>
          </tr>
        

        

        

        
  </table>

  
    <h2 id="simple-summary">Simple Summary</h2>
<p>This EIP extends EIP-55 by optionally adding a chain id defined by EIP-155 to the checksum calculation.</p>
<h2 id="abstract">Abstract</h2>
<p>The EIP-55 was created to prevent users from losing funds by sending them to invalid addresses. This EIP extends EIP-55 to protect users from losing funds by sending them to addresses that are valid but that where obtained from a client of another network.For example, if this EIP is implemented, a wallet can alert the user that is trying to send funds to an Ethereum Testnet address from an Ethereum Mainnet wallet.</p>
<h2 id="motivation">Motivation</h2>
<p>The motivation of this proposal is to provide a mechanism to allow software to distinguish addresses from different Ethereum based networks. This proposal is necessary because Ethereum addresses are hashes of public keys and do not include any metadata. By extending the EIP-55 checksum algorithm it is possible to achieve this objective.</p>
<h2 id="specification">Specification</h2>
<p>Convert the address using the same algorithm defined by EIP-55 but if a registered chain id is provided, add it to the input of the hash function. If the chain id passed to the function belongs to a network that opted for using this checksum variant, prefix the address with the chain id and the <code>0x</code> separator before calculating the hash. Then convert the address to hexadecimal, but if the ith digit is a letter (ie. it's one of <code>abcdef</code>) print it in uppercase if the 4*ith bit of the calculated hash is 1 otherwise print it in lowercase.</p>
<h2 id="rationale">Rationale</h2>
<p>Benefits:</p>
<ul>
<li>By means of a minimal code change on existing libraries, users are protected from losing funds by mixing addresses of different Ethereum based networks.</li>
</ul>
<h2 id="backwards-compatibility">Backwards Compatibility</h2>
<p>This proposal is fully backward compatible. The checksum calculation is changed only for new networks that choose to adopt this EIP and add their chain numbers to the Adoption Table included in this document.</p>
<h2 id="implementation">Implementation</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#65737e;">#!/usr/bin/python3
</span><span style="color:#b48ead;">from </span><span style="color:#c0c5ce;">sha3 </span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">keccak_256
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">random
</span><span style="color:#65737e;">&quot;&quot;&quot;
   addr (str): Hexadecimal address, 40 characters long with 2 characters prefix
   chainid (int): chain id from EIP-155 &quot;&quot;&quot;
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">eth_checksum_encode</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">addr</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">chainid</span><span style="color:#c0c5ce;">=</span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">):
    adopted_eip1191 = [</span><span style="color:#d08770;">30</span><span style="color:#c0c5ce;">, </span><span style="color:#d08770;">31</span><span style="color:#c0c5ce;">]
    hash_input = </span><span style="color:#bf616a;">str</span><span style="color:#c0c5ce;">(chainid) + addr.</span><span style="color:#bf616a;">lower</span><span style="color:#c0c5ce;">() </span><span style="color:#b48ead;">if </span><span style="color:#c0c5ce;">chainid in adopted_eip1191 </span><span style="color:#b48ead;">else </span><span style="color:#c0c5ce;">addr[</span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">:].</span><span style="color:#bf616a;">lower</span><span style="color:#c0c5ce;">()
    hash_output = </span><span style="color:#bf616a;">keccak_256</span><span style="color:#c0c5ce;">(hash_input.</span><span style="color:#bf616a;">encode</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">utf8</span><span style="color:#c0c5ce;">&#39;)).</span><span style="color:#bf616a;">hexdigest</span><span style="color:#c0c5ce;">()
    aggregate = </span><span style="color:#96b5b4;">zip</span><span style="color:#c0c5ce;">(addr[</span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">:].</span><span style="color:#bf616a;">lower</span><span style="color:#c0c5ce;">(),hash_output)
    out = addr[:</span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">] + &#39;&#39;.</span><span style="color:#bf616a;">join</span><span style="color:#c0c5ce;">([c.</span><span style="color:#bf616a;">upper</span><span style="color:#c0c5ce;">() </span><span style="color:#b48ead;">if </span><span style="color:#bf616a;">int</span><span style="color:#c0c5ce;">(a,</span><span style="color:#d08770;">16</span><span style="color:#c0c5ce;">) &gt;= </span><span style="color:#d08770;">8 </span><span style="color:#b48ead;">else </span><span style="color:#c0c5ce;">c </span><span style="color:#b48ead;">for </span><span style="color:#c0c5ce;">c,a </span><span style="color:#b48ead;">in </span><span style="color:#c0c5ce;">aggregate])
    </span><span style="color:#b48ead;">return </span><span style="color:#c0c5ce;">out
</span></code></pre><h2 id="test-cases">Test Cases</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">eth_mainnet = [
&quot;</span><span style="color:#a3be8c;">0x27b1fdb04752bbc536007a920d24acb045561c26</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x3599689E6292b81B2d85451025146515070129Bb</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x42712D45473476b98452f434e72461577D686318</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x52908400098527886E0F7030069857D2E4169EE7</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x5aAeb6053F3E94C9b9A09f33669435E7Ef1BeAed</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x6549f4939460DE12611948b3f82b88C3C8975323</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x66f9664f97F2b50F62D13eA064982f936dE76657</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x8617E340B3D01FA5F11F306F4090FD50E238070D</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x88021160C5C792225E4E5452585947470010289D</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xD1220A0cf47c7B9Be7A2E6BA89F429762e7b9aDb</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xdbF03B407c01E7cD3CBea99509d93f8DDDC8C6FB</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xde709f2102306220921060314715629080e2fb77</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xfB6916095ca1df60bB79Ce92cE3Ea74c37c5d359</span><span style="color:#c0c5ce;">&quot;,
]
rsk_mainnet = [
&quot;</span><span style="color:#a3be8c;">0x27b1FdB04752BBc536007A920D24ACB045561c26</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x3599689E6292B81B2D85451025146515070129Bb</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x42712D45473476B98452f434E72461577d686318</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x52908400098527886E0F7030069857D2E4169ee7</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x5aaEB6053f3e94c9b9a09f33669435E7ef1bEAeD</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x6549F4939460DE12611948B3F82B88C3C8975323</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x66F9664f97f2B50F62d13EA064982F936de76657</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x8617E340b3D01Fa5f11f306f4090fd50E238070D</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x88021160c5C792225E4E5452585947470010289d</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xD1220A0Cf47c7B9BE7a2e6ba89F429762E7B9adB</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xDBF03B407c01E7CD3cBea99509D93F8Dddc8C6FB</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xDe709F2102306220921060314715629080e2FB77</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xFb6916095cA1Df60bb79ce92cE3EA74c37c5d359</span><span style="color:#c0c5ce;">&quot;,
]
rsk_testnet = [
&quot;</span><span style="color:#a3be8c;">0x27B1FdB04752BbC536007a920D24acB045561C26</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x3599689e6292b81b2D85451025146515070129Bb</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x42712D45473476B98452F434E72461577D686318</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x52908400098527886E0F7030069857D2e4169EE7</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x5aAeb6053F3e94c9b9A09F33669435E7EF1BEaEd</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x6549f4939460dE12611948b3f82b88C3c8975323</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x66f9664F97F2b50f62d13eA064982F936DE76657</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x8617e340b3D01fa5F11f306F4090Fd50e238070d</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0x88021160c5C792225E4E5452585947470010289d</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xd1220a0CF47c7B9Be7A2E6Ba89f429762E7b9adB</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xdbF03B407C01E7cd3cbEa99509D93f8dDDc8C6fB</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xDE709F2102306220921060314715629080e2Fb77</span><span style="color:#c0c5ce;">&quot;,
&quot;</span><span style="color:#a3be8c;">0xFb6916095CA1dF60bb79CE92ce3Ea74C37c5D359</span><span style="color:#c0c5ce;">&quot;,
]
test_cases = {</span><span style="color:#d08770;">30 </span><span style="color:#c0c5ce;">: rsk_mainnet, </span><span style="color:#d08770;">31 </span><span style="color:#c0c5ce;">: rsk_testnet, </span><span style="color:#d08770;">1 </span><span style="color:#c0c5ce;">: eth_mainnet}

</span><span style="color:#b48ead;">for </span><span style="color:#c0c5ce;">chainid, cases </span><span style="color:#b48ead;">in </span><span style="color:#c0c5ce;">test_cases.</span><span style="color:#bf616a;">items</span><span style="color:#c0c5ce;">():
    </span><span style="color:#b48ead;">for </span><span style="color:#c0c5ce;">addr </span><span style="color:#b48ead;">in </span><span style="color:#c0c5ce;">cases:
        </span><span style="color:#b48ead;">assert </span><span style="color:#c0c5ce;">( addr == </span><span style="color:#bf616a;">eth_checksum_encode</span><span style="color:#c0c5ce;">(addr,chainid) )
</span></code></pre><h2 id="adoption">Adoption</h2>
<h3 id="adoption-table">Adoption  Table</h3>
<table><thead><tr><th>Network</th><th>Chain id</th><th>Supports this EIP</th></tr></thead><tbody>
<tr><td>RSK Mainnet</td><td>30</td><td>Yes</td></tr>
<tr><td>RSK Testnet</td><td>31</td><td>Yes</td></tr>
</tbody></table>
<h3 id="implementation-table">Implementation Table</h3>
<table><thead><tr><th>Project</th><th>Adopted this EIP</th><th>Implementation</th></tr></thead><tbody>
<tr><td>MyCrypto</td><td>Yes</td><td><a href="https://github.com/MyCryptoHQ/MyCrypto/blob/develop/common/utils/formatters.ts#L126">JavaScript</a></td></tr>
<tr><td>MyEtherWallet</td><td>Yes</td><td><a href="https://github.com/MyEtherWallet/MyEtherWallet/blob/73c4a24f8f67c655749ac990c5b62efd92a2b11a/src/helpers/addressUtils.js#L22">JavaScript</a></td></tr>
<tr><td>Ledger</td><td>Yes</td><td><a href="https://github.com/LedgerHQ/ledger-app-eth/blob/master/src_common/ethUtils.c#L203">C</a></td></tr>
<tr><td>Trezor</td><td>Yes</td><td><a href="https://github.com/trezor/trezor-core/blob/270bf732121d004a4cd1ab129adaccf7346ff1db/src/apps/ethereum/get_address.py#L32">Python</a> and <a href="https://github.com/trezor/trezor-crypto/blob/4153e662b60a0d83c1be15150f18483a37e9092c/address.c#L62">C</a></td></tr>
<tr><td>Web3.js</td><td>Yes</td><td><a href="https://github.com/ethereum/web3.js/blob/aaf26c8806bc9fb60cf6dcb6658104963c6c7fc7/packages/web3-utils/src/Utils.js#L140">JavaScript</a></td></tr>
<tr><td>EthereumJS-util</td><td>Yes</td><td><a href="https://github.com/ethereumjs/ethereumjs-util/pull/204/commits/cdf0b3c996b05ac5b1f758f17ea9f9ed1847c1eb">JavaScript</a></td></tr>
<tr><td>ENS address-encoder</td><td>Yes</td><td><a href="https://github.com/ensdomains/address-encoder/commit/5bf53b13fa014646ea28c9e5f937361dc9b40590">TypeScript</a></td></tr>
</tbody></table>
<h2 id="copyright">Copyright</h2>
<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>



            </div>
        </main>


        <footer class="site-footer h-card">
            <div class="wrapper">
                <h2 class="footer-heading">Ethereum Improvement Proposals</h2>
                <div class="footer-col-wrapper">
                    <div class="footer-col footer-col-1">
                        <ul class="contact-list">
                            <li class="p-name">
                                
                                GitHub User
                                
                            </li>
                            <li>
                                <a class="u-email" href="mailto:your-email@domain.com">
                                  your-email@domain.com
                                </a>
                              </li>
                            </ul>
                    </div>
                    <div class="footer-col footer-col-3">
                        <p>Description</p>
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>
