<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https:&#x2F;&#x2F;eips.ethereum.com&#x2F;minima.css">

        <!-- opengraph -->
        <meta property="og:locale" content="en_US" />
        <meta property="og:url" content="https:&#x2F;&#x2F;eips.ethereum.com" />
        <meta property="og:site_name" content="Ethereum Improvement Proposals" />

        <!-- twitter -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@ethereum" />

        <script type="application/ld+json">
            {
              "@type": "WebSite",
              "url": "https:&#x2F;&#x2F;eips.ethereum.com",
              "name": "Ethereum Improvement Proposals",
              "description": "Description",
              "@context": "https://schema.org"
            }
        </script>

        

        

<title>EIP-1102: Opt-in account exposure</title>
<link rel="canonical" href="https:&#x2F;&#x2F;eips.ethereum.comEIPS&#x2F;eip-1102.md" />
<meta property="og:title" content="EIP-1102: Opt-in account exposure" />
<meta
    name="description"
    content="Details on Ethereum Improvement Proposal 1102 (EIP-1102): Opt-in account exposure"
/>
<meta
    property="og:description"
    content="Details on Ethereum Improvement Proposal 1102 (EIP-1102): Opt-in account exposure"
/>
<meta property="og:url" content="https:&#x2F;&#x2F;eips.ethereum.comEIPS&#x2F;eip-1102.md" />
<meta name="twitter:description" content="Details on Ethereum Improvement Proposal 1102 (EIP 1102): Opt-in account exposure" />

    </head>
    <body>
        <header class="site-header">
            <div class="wrapper">
                <a class="site-title" rel="author" href="https:&#x2F;&#x2F;eips.ethereum.com">Ethereum Improvement Proposals</a>
                <nav class="site-nav">
                    <input type="checkbox" id="nav-trigger" class="nav-trigger" />
                    <label for="nav-trigger">
                        <span class="menu-icon">
                            <svg viewBox="0 0 18 15" width="18px" height="15px">
                                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
                            </svg>
                        </span>
                    </label>

                    <div class="trigger">
                        
                            <a class="page-link" href="&#x2F;all">All</a>
                        
                            <a class="page-link" href="&#x2F;core">Core</a>
                        
                            <a class="page-link" href="&#x2F;networking">Networking</a>
                        
                            <a class="page-link" href="&#x2F;interface">Interface</a>
                        
                            <a class="page-link" href="&#x2F;erc">ERC</a>
                        
                            <a class="page-link" href="&#x2F;meta">Meta</a>
                        
                            <a class="page-link" href="&#x2F;informational">Informational</a>
                        
                    </div>
                </nav>
            </div>
        </header>
        <main class="page-content" aria-label="Content">
            <div class="wrapper">
                
<div class="home">
    <h1 class="page-heading">
        EIP-1102: Opt-in account exposure
        <a href=""><svg role="img" aria-label="Source" xmlns="https://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><title>Source</title><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg></a>
    </h1>
    <table>
        <tr>
            <th>Author</th>
            <td>
    
        
        
            <a href="mailto:mail@bitpshr.net">Paul Bouchon</a>,
        
    
        
        
            <a href="mailto:rekmarks@protonmail.com">Erik Marks</a>
        
    
</td>
        </tr>

        
          <tr>
              <th>Discussions-To</th>
              <td><a href="https:&#x2F;&#x2F;ethereum-magicians.org&#x2F;t&#x2F;eip-1102-opt-in-provider-access&#x2F;414">https:&#x2F;&#x2F;ethereum-magicians.org&#x2F;t&#x2F;eip-1102-opt-in-provider-access&#x2F;414</a></td>
          </tr>
        

        <tr>
            <th>Status</th>
            <td>
                Draft
                
            </td>
        </tr>

        <tr>
            <th>Type</th>
            <td>Standards Track</td>
        </tr>

        
          <tr>
              <th>Category</th>
              <td>Interface</td>
          </tr>
        

        <tr>
            <th>Created</th>
            <td>2018-05-04</td>
        </tr>

        

        
          <tr>
              <th>Requires</th>
              <td>1474</td>
          </tr>
        

        

        

        
  </table>

  
    <h2 id="simple-summary">Simple summary</h2>
<p>This proposal describes a communication protocol between dapps and Ethereum-enabled DOM environments that allows the Ethereum-enabled DOM environment to choose what information to supply the dapp with and when.</p>
<h2 id="abstract">Abstract</h2>
<p>The previous generation of Ethereum-enabled DOM environments follows a pattern of injecting a provider populated with accounts without user consent. This puts users of such environments at risk because malicious websites can use these accounts to view detailed account information and to arbitrarily initiate unwanted transactions on a user's behalf.</p>
<p>This proposal outlines a protocol in which Ethereum-enabled DOM environments can choose to expose no accounts until the user approves account access.</p>
<h2 id="specification">Specification</h2>
<h3 id="concepts">Concepts</h3>
<h4 id="rfc-2119">RFC-2119</h4>
<p>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;,  &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC-2119</a>.</p>
<h4 id="eth-requestaccounts"><code>eth_requestAccounts</code></h4>
<p>Providers exposed by Ethereum-enabled DOM environments define a new RPC method: <code>eth_requestAccounts</code>. Calling this method may trigger a user interface that allows the user to approve or reject account access for a given dapp. This method returns a <code>Promise</code> that is resolved with an <code>Array</code> of accounts or is rejected with an <code>Error</code> if accounts are not available.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">ethereum</span><span style="color:#c0c5ce;">.</span><span style="color:#96b5b4;">send</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">eth_requestAccounts</span><span style="color:#c0c5ce;">&#39;): </span><span style="color:#ebcb8b;">Promise</span><span style="color:#c0c5ce;">&lt;</span><span style="color:#ebcb8b;">Array</span><span style="color:#c0c5ce;">&lt;</span><span style="color:#bf616a;">string</span><span style="color:#c0c5ce;">&gt;&gt;
</span></code></pre><h4 id="provider-enable-deprecated">Provider#enable (DEPRECATED)</h4>
<p><strong>Note: This method is deprecated in favor of the RPC method <a href="https://eips.ethereum.com/EIPS/eip-1102/#eth_requestaccounts"><code>eth_requestAccounts</code></a>.</strong></p>
<p>Providers exposed by Ethereum-enabled DOM environments define a new RPC method: <code>ethereum.enable()</code>. Calling this method triggers a user interface that allows the user to approve or reject account access for a given dapp. This method returns a <code>Promise</code> that is resolved with an <code>Array</code> of accounts if the user approves access or rejected with an <code>Error</code> if the user rejects access.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">ethereum</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">enable</span><span style="color:#c0c5ce;">(): </span><span style="color:#ebcb8b;">Promise</span><span style="color:#c0c5ce;">&lt;</span><span style="color:#bf616a;">any</span><span style="color:#c0c5ce;">&gt;
</span></code></pre><h3 id="protocol">Protocol</h3>
<h4 id="legacy-dapp-initialization">Legacy dapp initialization</h4>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">START dapp
IF web3 is defined
    CONTINUE dapp
IF web3 is undefined
    STOP dapp
</span></code></pre><h4 id="proposed-dapp-initialization">Proposed dapp initialization</h4>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">START dapp
IF provider is defined
    REQUEST[1] account access
    IF user approves
        RESOLVE[2] account access
        CONTINUE dapp
    IF user rejects
        REJECT[3] account access
        STOP dapp
IF provider is undefined
    STOP dapp
</span></code></pre><h5 id="1-request"><code>[1] REQUEST</code></h5>
<p>Dapps <strong>MUST</strong> request accounts by calling the <code>eth_requestAccounts</code> RPC method on the provider exposed at <code>window.ethereum</code>. Calling this method <strong>MAY</strong> trigger a user interface that allows the user to approve or reject account access for a given dapp. This method <strong>MUST</strong> return a <code>Promise</code> that is resolved with an array of one or more user accounts or rejected if no accounts are available (e.g., the user rejected account access).</p>
<h5 id="2-resolve"><code>[2] RESOLVE</code></h5>
<p>The <code>Promise</code> returned when calling the <code>eth_requestAccounts</code> RPC method <strong>MUST</strong> be resolved with an <code>Array</code> of user accounts.</p>
<h5 id="3-reject"><code>[3] REJECT</code></h5>
<p>The <code>Promise</code> returned when calling the <code>eth_requestAccounts</code> RPC method <strong>MUST</strong> be rejected with an informative <code>Error</code> if no accounts are available for any reason.</p>
<h3 id="example-initialization">Example initialization</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">try </span><span style="color:#c0c5ce;">{
    </span><span style="color:#65737e;">// Request account access if needed
    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">accounts </span><span style="color:#c0c5ce;">= </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">ethereum</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">send</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">eth_requestAccounts</span><span style="color:#c0c5ce;">&#39;);
    </span><span style="color:#65737e;">// Accounts now exposed, use them
    </span><span style="color:#bf616a;">ethereum</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">send</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">eth_sendTransaction</span><span style="color:#c0c5ce;">&#39;, { from: </span><span style="color:#bf616a;">accounts</span><span style="color:#c0c5ce;">[</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">], </span><span style="color:#65737e;">/* ... */ </span><span style="color:#c0c5ce;">})
} </span><span style="color:#b48ead;">catch </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">error</span><span style="color:#c0c5ce;">) {
    </span><span style="color:#65737e;">// User denied account access
</span><span style="color:#c0c5ce;">}
</span></code></pre><h3 id="constraints">Constraints</h3>
<ul>
<li>Browsers <strong>MUST</strong> expose a provider at <code>window.ethereum</code> .</li>
<li>Browsers <strong>MUST</strong> define an <code>eth_requestAccounts</code> RPC method.</li>
<li>Browsers <strong>MAY</strong> wait for a user interaction before resolving/rejecting the <code>eth_requestAccounts</code> promise.</li>
<li>Browsers <strong>MUST</strong> include at least one account if the <code>eth_requestAccounts</code> promise is resolved.</li>
<li>Browsers <strong>MUST</strong> reject the promise with an informative error if no accounts are available.</li>
</ul>
<h2 id="rationale">Rationale</h2>
<p>The pattern of automatic account exposure followed by the previous generation of Ethereum-enabled DOM environments fails to protect user privacy and fails to maintain safe user experience: untrusted websites can both view detailed account information and arbitrarily initiate transactions on a user's behalf. Even though most users may reject unsolicited transactions on untrusted websites, a protocol for account access should make such unsolicited requests impossible.</p>
<p>This proposal establishes a new pattern wherein dapps must request access to user accounts. This protocol directly strengthens user privacy by allowing the browser to hide user accounts and preventing unsolicited transaction requests on untrusted sites.</p>
<h3 id="immediate-value-add">Immediate value-add</h3>
<ul>
<li>Users can reject account access on untrusted sites to hide accounts.</li>
<li>Users can reject account access on untrusted sites to prevent unsolicited transactions.</li>
</ul>
<h3 id="long-term-value-add">Long-term value-add</h3>
<ul>
<li>Dapps could request specific account information based on user consent.</li>
<li>Dapps could request specific user information based on user consent (uPort, DIDs).</li>
<li>Dapps could request a specific network based on user consent.</li>
<li>Dapps could request multiple instances of the above based on user consent.</li>
</ul>
<h2 id="backwards-compatibility">Backwards compatibility</h2>
<p>This proposal impacts dapp developers and requires that they request access to user accounts following the protocol outlined above. Similarly, this proposal impacts dapp browser developers and requires that they only expose user accounts following the protocol defined above.</p>
<h2 id="implementation">Implementation</h2>
<p>The MetaMask team <a href="https://github.com/MetaMask/metamask-extension/pull/4703">has implemented</a> the strategy described above.</p>
<h2 id="copyright">Copyright</h2>
<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>



            </div>
        </main>


        <footer class="site-footer h-card">
            <div class="wrapper">
                <h2 class="footer-heading">Ethereum Improvement Proposals</h2>
                <div class="footer-col-wrapper">
                    <div class="footer-col footer-col-1">
                        <ul class="contact-list">
                            <li class="p-name">
                                
                                GitHub User
                                
                            </li>
                            <li>
                                <a class="u-email" href="mailto:your-email@domain.com">
                                  your-email@domain.com
                                </a>
                              </li>
                            </ul>
                    </div>
                    <div class="footer-col footer-col-3">
                        <p>Description</p>
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>
