<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https:&#x2F;&#x2F;eips.ethereum.com&#x2F;minima.css">

        <!-- opengraph -->
        <meta property="og:locale" content="en_US" />
        <meta property="og:url" content="https:&#x2F;&#x2F;eips.ethereum.com" />
        <meta property="og:site_name" content="Ethereum Improvement Proposals" />

        <!-- twitter -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@ethereum" />

        <script type="application/ld+json">
            {
              "@type": "WebSite",
              "url": "https:&#x2F;&#x2F;eips.ethereum.com",
              "name": "Ethereum Improvement Proposals",
              "description": "Description",
              "@context": "https://schema.org"
            }
        </script>

        

        

<title>EIP-1207: DAuth Access Delegation Standard</title>
<link rel="canonical" href="https:&#x2F;&#x2F;eips.ethereum.comEIPS&#x2F;eip-1207.md" />
<meta property="og:title" content="EIP-1207: DAuth Access Delegation Standard" />
<meta
    name="description"
    content="Details on Ethereum Improvement Proposal 1207 (EIP-1207): DAuth Access Delegation Standard"
/>
<meta
    property="og:description"
    content="Details on Ethereum Improvement Proposal 1207 (EIP-1207): DAuth Access Delegation Standard"
/>
<meta property="og:url" content="https:&#x2F;&#x2F;eips.ethereum.comEIPS&#x2F;eip-1207.md" />
<meta name="twitter:description" content="Details on Ethereum Improvement Proposal 1207 (EIP 1207): DAuth Access Delegation Standard" />

    </head>
    <body>
        <header class="site-header">
            <div class="wrapper">
                <a class="site-title" rel="author" href="https:&#x2F;&#x2F;eips.ethereum.com">Ethereum Improvement Proposals</a>
                <nav class="site-nav">
                    <input type="checkbox" id="nav-trigger" class="nav-trigger" />
                    <label for="nav-trigger">
                        <span class="menu-icon">
                            <svg viewBox="0 0 18 15" width="18px" height="15px">
                                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
                            </svg>
                        </span>
                    </label>

                    <div class="trigger">
                        
                            <a class="page-link" href="&#x2F;all">All</a>
                        
                            <a class="page-link" href="&#x2F;core">Core</a>
                        
                            <a class="page-link" href="&#x2F;networking">Networking</a>
                        
                            <a class="page-link" href="&#x2F;interface">Interface</a>
                        
                            <a class="page-link" href="&#x2F;erc">ERC</a>
                        
                            <a class="page-link" href="&#x2F;meta">Meta</a>
                        
                            <a class="page-link" href="&#x2F;informational">Informational</a>
                        
                    </div>
                </nav>
            </div>
        </header>
        <main class="page-content" aria-label="Content">
            <div class="wrapper">
                
<div class="home">
    <h1 class="page-heading">
        EIP-1207: DAuth Access Delegation Standard
        <a href=""><svg role="img" aria-label="Source" xmlns="https://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><title>Source</title><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg></a>
    </h1>
    <table>
        <tr>
            <th>Author</th>
            <td>
    
        
        
            <a href="https://github.com/wxygeek">Xiaoyu Wang</a>,
        
    
        
        
            <a href="https://github.com/Wangbicong"> Bicong Wang</a>
        
    
</td>
        </tr>

        
          <tr>
              <th>Discussions-To</th>
              <td><a href="https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;EIPs&#x2F;issues&#x2F;1207">https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;EIPs&#x2F;issues&#x2F;1207</a></td>
          </tr>
        

        <tr>
            <th>Status</th>
            <td>
                Draft
                
            </td>
        </tr>

        <tr>
            <th>Type</th>
            <td>Standards Track</td>
        </tr>

        
          <tr>
              <th>Category</th>
              <td>ERC</td>
          </tr>
        

        <tr>
            <th>Created</th>
            <td>2018-07-10</td>
        </tr>

        

        

        

        

        
  </table>

  
    <h1 id="dauth-access-delegation-standard">DAuth Access Delegation Standard</h1>
<h2 id="simple-summary">Simple Summary</h2>
<p>DAuth is a standard interface for accessing authorization delegation between smart contracts and users.</p>
<h2 id="abstract">Abstract</h2>
<p>The DAuth protocol defines a set of standard API allowing identity delegations between smart contracts without the user's private key.  Identity delegations include accessing and operating a user's data and assets contained in the delegated contracts.</p>
<h2 id="motivation">Motivation</h2>
<p>The inspiration for designing DAuth comes from OAuth protocol that is extensively used in web applications. But unlike the centralized authorization of OAuth, DAuth works in a  distributed manner, thus providing much more reliability and generality.</p>
<h2 id="specification">Specification</h2>
<p><img src="../assets/eip-1207/rationale.png" alt="Rationale" /></p>
<p><strong>Resource owner</strong>: the authorizer</p>
<p><strong>Resource contract</strong>: the contract providing data and operators</p>
<p><strong>API</strong>: the resource contract APIs that the grantee contract can invoke</p>
<p><strong>Client contract</strong>: the grantee contract using authorization to access and operate the data</p>
<p><strong>Grantee request</strong>: the client contract calls the resource contract with the authorizer authorization</p>
<p><strong>AuthInfo</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">struct AuthInfo </span><span style="color:#c0c5ce;">{
    </span><span style="color:#bf616a;">string</span><span style="color:#c0c5ce;">[] </span><span style="color:#bf616a;">funcNames</span><span style="color:#c0c5ce;">;
    </span><span style="color:#bf616a;">uint expireAt</span><span style="color:#c0c5ce;">;
}
</span></code></pre>
<p>Required - The struct contains user authorization information</p>
<ul>
<li><code>funcNames</code>: a list of function names callable by the granted contract</li>
<li><code>expireAt</code>: the authorization expire timestamp in seconds</li>
</ul>
<p><strong>userAuth</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">mapping</span><span style="color:#c0c5ce;">(address </span><span style="color:#b48ead;">=&gt; </span><span style="color:#bf616a;">mapping</span><span style="color:#c0c5ce;">(address </span><span style="color:#b48ead;">=&gt; </span><span style="color:#bf616a;">AuthInfo</span><span style="color:#c0c5ce;">)) </span><span style="color:#bf616a;">userAuth</span><span style="color:#c0c5ce;">;
</span></code></pre>
<p>Required - userAuth maps (authorizer address, grantee contract address) pair to the user’s authorization AuthInfo object</p>
<p><strong>callableFuncNames</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">string</span><span style="color:#c0c5ce;">[] </span><span style="color:#bf616a;">callableFuncNames</span><span style="color:#c0c5ce;">;
</span></code></pre>
<p>Required - All methods that are allowed other contracts to call</p>
<ul>
<li>The callable function MUST verify the grantee’s authorization</li>
</ul>
<p><strong>updateCallableFuncNames</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">updateCallableFuncNames</span><span style="color:#c0c5ce;">(string _invokes) </span><span style="color:#bf616a;">public returns </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">bool success</span><span style="color:#c0c5ce;">);
</span></code></pre>
<p>Optional - Update the callable function list for the client contract by the resource contract's administrator</p>
<ul>
<li><code>_invokes</code>: the invoke methods that the client contract can call</li>
<li>return: Whether the callableFuncNames is updated or not</li>
<li>This method MUST return success or throw, no other outcomes can be possible</li>
</ul>
<p><strong>verify</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">verify</span><span style="color:#c0c5ce;">(address _authorizer, string _invoke) </span><span style="color:#bf616a;">internal returns </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">bool success</span><span style="color:#c0c5ce;">);
</span></code></pre>
<p>Required - check the invoke method authority for the client contract</p>
<ul>
<li><code>_authorizer</code>: the user address that the client contract agents</li>
<li><code>_invoke</code>: the invoke method that the client contract wants to call</li>
<li>return: Whether the grantee request is authorized or not</li>
<li>This method MUST return success or throw, no other outcomes can be possible</li>
</ul>
<p><strong>grant</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">grant</span><span style="color:#c0c5ce;">(address _grantee, string _invokes, uint _expireAt) </span><span style="color:#bf616a;">public returns </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">bool success</span><span style="color:#c0c5ce;">);
</span></code></pre>
<p>Required - delegate a client contract to access the user's resource</p>
<ul>
<li><code>_grantee</code>: the client contract address</li>
<li><code>_invokes</code>: the callable methods that the client contract can access. It is a string which contains all function names split by spaces</li>
<li><code>_expireAt</code>: the authorization expire timestamp in seconds</li>
<li>return: Whether the grant is successful or not</li>
<li>This method MUST return success or throw, no other outcomes can be possible</li>
<li>A successful grant MUST fire the Grant event(defined below)</li>
</ul>
<p><strong>regrant</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">regrant</span><span style="color:#c0c5ce;">(address _grantee, string _invokes, uint _expireAt) </span><span style="color:#bf616a;">public returns </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">bool success</span><span style="color:#c0c5ce;">);
</span></code></pre>
<p>Optional - alter a client contract's delegation</p>
<p><strong>revoke</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">revoke</span><span style="color:#c0c5ce;">(address _grantee) </span><span style="color:#bf616a;">public returns </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">bool success</span><span style="color:#c0c5ce;">);
</span></code></pre>
<p>Required - delete a client contract's delegation</p>
<ul>
<li><code>_grantee</code>: the client contract address</li>
<li>return: Whether the revoke is successful or not</li>
<li>A successful revoke MUST fire the Revoke event(defined below).</li>
</ul>
<p><strong>Grant</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">event Grant</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">address _authorizer</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">address _grantee</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">string _invokes</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">uint _expireAt</span><span style="color:#c0c5ce;">);
</span></code></pre>
<ul>
<li>This event MUST trigger when the authorizer grant a new authorization when <code>grant</code> or <code>regrant</code> processes successfully</li>
</ul>
<p><strong>Revoke</strong></p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">event Revoke</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">address _authorizer</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">address _grantee</span><span style="color:#c0c5ce;">);
</span></code></pre>
<ul>
<li>This event MUST trigger when the authorizer revoke a specific authorization successfully</li>
</ul>
<p><strong>Callable Resource Contract Functions</strong></p>
<p>All public or external functions that are allowed the grantee to call MUST use overload to implement two functions: The First one is the standard method that the user invokes directly, the second one is the grantee methods of the same function name with one more authorizer address parameter.</p>
<p>Example:</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">approve</span><span style="color:#c0c5ce;">(address _spender, uint256 _value) </span><span style="color:#bf616a;">public returns </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">bool success</span><span style="color:#c0c5ce;">) {
    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">_approve</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">msg</span><span style="color:#c0c5ce;">.sender, </span><span style="color:#bf616a;">_spender</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">_value</span><span style="color:#c0c5ce;">);
}

</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">approve</span><span style="color:#c0c5ce;">(address _spender, uint256 _value, address _authorizer) </span><span style="color:#bf616a;">public returns </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">bool success</span><span style="color:#c0c5ce;">) {
    </span><span style="color:#bf616a;">verify</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">_authorizer</span><span style="color:#c0c5ce;">, &quot;</span><span style="color:#a3be8c;">approve</span><span style="color:#c0c5ce;">&quot;);

    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">_approve</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">_authorizer</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">_spender</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">_value</span><span style="color:#c0c5ce;">);
}

</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">_approve</span><span style="color:#c0c5ce;">(address sender, address _spender, uint256 _value) </span><span style="color:#bf616a;">internal returns </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">bool success</span><span style="color:#c0c5ce;">) {
    </span><span style="color:#bf616a;">allowed</span><span style="color:#c0c5ce;">[</span><span style="color:#bf616a;">sender</span><span style="color:#c0c5ce;">][</span><span style="color:#bf616a;">_spender</span><span style="color:#c0c5ce;">] = </span><span style="color:#bf616a;">_value</span><span style="color:#c0c5ce;">;
    </span><span style="color:#bf616a;">emit Approval</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">sender</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">_spender</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">_value</span><span style="color:#c0c5ce;">);
    </span><span style="color:#b48ead;">return </span><span style="color:#d08770;">true</span><span style="color:#c0c5ce;">;
}
</span></code></pre><h2 id="rationale">Rationale</h2>
<p><strong>Current Limitations</strong></p>
<p>The current design of many smart contracts only considers the user invokes the smart contract functions by themselves using the private key. However, in some case, the user wants to delegate other client smart contracts to access and operate their data or assets in the resource smart contract. There isn’t a common protocol to provide a standard delegation approach.</p>
<p><strong>Rationale</strong></p>
<p>On the Ethereum platform, all storage is transparent and the <code>msg.sender</code> is reliable. Therefore, the DAuth don't need an <code>access_token</code> like OAuth. DAuth just recodes the users' authorization for the specific client smart contract's address. It is simple and reliable on the Ethereum platform.</p>
<h2 id="backwards-compatibility">Backwards Compatibility</h2>
<p>This EIP introduces no backward compatibility issues. In the future, the new version protocol has to keep these interfaces.</p>
<h2 id="implementation">Implementation</h2>
<p>Following is the DAuth Interface implementation. Furthermore, the example implementations of EIP20 Interface and ERC-DAuth Interface are also provided. Developers can easily implement their own contracts with ERC-DAuth Interface and other EIP.</p>
<ul>
<li>
<p>ERC-DAuth Interface implementation is available at:</p>
<p>https://github.com/DIA-Network/ERC-DAuth/blob/master/ERC-DAuth-Interface.sol</p>
</li>
<li>
<p>Example implementation with EIP20 Interface and ERC-DAuth Interface is available at:</p>
<p>https://github.com/DIA-Network/ERC-DAuth/blob/master/eip20-dauth-example/EIP20DAuth.sol</p>
</li>
</ul>
<h2 id="copyright">Copyright</h2>
<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>



            </div>
        </main>


        <footer class="site-footer h-card">
            <div class="wrapper">
                <h2 class="footer-heading">Ethereum Improvement Proposals</h2>
                <div class="footer-col-wrapper">
                    <div class="footer-col footer-col-1">
                        <ul class="contact-list">
                            <li class="p-name">
                                
                                GitHub User
                                
                            </li>
                            <li>
                                <a class="u-email" href="mailto:your-email@domain.com">
                                  your-email@domain.com
                                </a>
                              </li>
                            </ul>
                    </div>
                    <div class="footer-col footer-col-3">
                        <p>Description</p>
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>
