<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https:&#x2F;&#x2F;eips.ethereum.com&#x2F;minima.css">

        <!-- opengraph -->
        <meta property="og:locale" content="en_US" />
        <meta property="og:url" content="https:&#x2F;&#x2F;eips.ethereum.com" />
        <meta property="og:site_name" content="Ethereum Improvement Proposals" />

        <!-- twitter -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@ethereum" />

        <script type="application/ld+json">
            {
              "@type": "WebSite",
              "url": "https:&#x2F;&#x2F;eips.ethereum.com",
              "name": "Ethereum Improvement Proposals",
              "description": "Description",
              "@context": "https://schema.org"
            }
        </script>

        

        

<title>EIP-1132: Extending ERC20 with token locking capability</title>
<link rel="canonical" href="https:&#x2F;&#x2F;eips.ethereum.comEIPS&#x2F;eip-1132.md" />
<meta property="og:title" content="EIP-1132: Extending ERC20 with token locking capability" />
<meta
    name="description"
    content="Details on Ethereum Improvement Proposal 1132 (EIP-1132): Extending ERC20 with token locking capability"
/>
<meta
    property="og:description"
    content="Details on Ethereum Improvement Proposal 1132 (EIP-1132): Extending ERC20 with token locking capability"
/>
<meta property="og:url" content="https:&#x2F;&#x2F;eips.ethereum.comEIPS&#x2F;eip-1132.md" />
<meta name="twitter:description" content="Details on Ethereum Improvement Proposal 1132 (EIP 1132): Extending ERC20 with token locking capability" />

    </head>
    <body>
        <header class="site-header">
            <div class="wrapper">
                <a class="site-title" rel="author" href="https:&#x2F;&#x2F;eips.ethereum.com">Ethereum Improvement Proposals</a>
                <nav class="site-nav">
                    <input type="checkbox" id="nav-trigger" class="nav-trigger" />
                    <label for="nav-trigger">
                        <span class="menu-icon">
                            <svg viewBox="0 0 18 15" width="18px" height="15px">
                                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
                            </svg>
                        </span>
                    </label>

                    <div class="trigger">
                        
                            <a class="page-link" href="&#x2F;all">All</a>
                        
                            <a class="page-link" href="&#x2F;core">Core</a>
                        
                            <a class="page-link" href="&#x2F;networking">Networking</a>
                        
                            <a class="page-link" href="&#x2F;interface">Interface</a>
                        
                            <a class="page-link" href="&#x2F;erc">ERC</a>
                        
                            <a class="page-link" href="&#x2F;meta">Meta</a>
                        
                            <a class="page-link" href="&#x2F;informational">Informational</a>
                        
                    </div>
                </nav>
            </div>
        </header>
        <main class="page-content" aria-label="Content">
            <div class="wrapper">
                
<div class="home">
    <h1 class="page-heading">
        EIP-1132: Extending ERC20 with token locking capability
        <a href=""><svg role="img" aria-label="Source" xmlns="https://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><title>Source</title><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg></a>
    </h1>
    <table>
        <tr>
            <th>Author</th>
            <td>
    
        
        
            <a href="mailto:nitika@govblocks.io">nitika-goel</a>
        
    
</td>
        </tr>

        
          <tr>
              <th>Discussions-To</th>
              <td><a href="https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;EIPs&#x2F;issues&#x2F;1132">https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;EIPs&#x2F;issues&#x2F;1132</a></td>
          </tr>
        

        <tr>
            <th>Status</th>
            <td>
                Draft
                
            </td>
        </tr>

        <tr>
            <th>Type</th>
            <td>Standards Track</td>
        </tr>

        
          <tr>
              <th>Category</th>
              <td>ERC</td>
          </tr>
        

        <tr>
            <th>Created</th>
            <td>2018-06-03</td>
        </tr>

        

        

        

        

        
  </table>

  
    <h2 id="simple-summary">Simple Summary</h2>
<p>An extension to the ERC20 standard with methods for time-locking of tokens within a contract.</p>
<h2 id="abstract">Abstract</h2>
<p>This proposal provides basic functionality to time-lock tokens within an ERC20 smart contract for multiple utilities without the need of transferring tokens to an external escrow smart contract.  It also allows fetching balance of locked and transferable tokens. </p>
<p>Time-locking can also be achieved via staking (#900), but that requires transfer of tokens to an escrow contract / stake manager, resulting in the following six concerns: </p>
<ol>
<li>additional trust on escrow contract / stake manager </li>
<li>additional approval process for token transfer</li>
<li>increased ops costs due to gas requirements in transfers</li>
<li>tough user experience as the user needs to claim the amount back from external escrows </li>
<li>inability for the user to track their true token balance / token activity </li>
<li>inability for the user to utilize their locked tokens within the token ecosystem.</li>
</ol>
<h2 id="motivation">Motivation</h2>
<p>dApps often require tokens to be time-locked against transfers for letting members 1) adhere to vesting schedules and 2) show skin in the game to comply with the underlying business process. I realized this need while building Nexus Mutual and GovBlocks. </p>
<p>In <a href="https://nexusmutual.io">Nexus Mutual</a>, claim assessors are required to lock their tokens before passing a vote for claims assessment. This is important as it ensures assessors’ skin in the game. The need here was that once a claim assessor locks his tokens for ‘n’ days, he should be able to cast multiple votes during that period of ‘n’ days, which is not feasible with staking mechanism.  There are other scenarios like skills/identity verification or participation in gamified token curated registries where time-locked tokens are required as well. </p>
<p>In <a href="https://govblocks.io">GovBlocks</a>, I wanted to allow dApps to lock member tokens for governance, while still allowing members to use those locked tokens for other activities within the dApp business. This is also the case with DGX governance model where they’ve proposed quarterly token locking for participation in governance activities of DGX. </p>
<p>In addition to locking functionality, I have proposed a <code>Lock()</code> and <code>Unlock()</code> event, just like the <code>Transfer()</code> event , to track token lock and unlock status. From token holder’s perspective, it gets tough to manage token holdings if certain tokens are transferred to another account for locking, because whenever <code>balanceOf()</code> queries are triggered on token holder’s account – the result does not include locked tokens. A <code>totalBalanceOf()</code> function intends to solve this problem.</p>
<p>The intention with this proposal is to enhance the ERC20 standard with token-locking capability so that dApps can time-lock tokens of the members without having to transfer tokens to an escrow / stake manager and at the same time allow members to use the locked tokens for multiple utilities.</p>
<h2 id="specification">Specification</h2>
<p>I’ve extended the ERC20 interface with the following enhancements:</p>
<h3 id="locking-of-tokens">Locking of tokens</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev Locks a specified amount of tokens against an address,
  *      for a specified reason and time
  * @param _reason The reason to lock tokens
  * @param _amount Number of tokens to be locked
  * @param _time Lock time in seconds
  */
function lock(bytes32 _reason, uint256 _amount, uint256 _time) public returns (bool)
</span></code></pre><h3 id="fetching-number-of-tokens-locked-under-each-utility">Fetching number of tokens locked under each utility</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev Returns tokens locked for a specified address for a
  *      specified reason
  *
  * @param _of The address whose tokens are locked
  * @param _reason The reason to query the lock tokens for
  */
   tokensLocked(address _of, bytes32 _reason) view returns (uint256 amount)
</span></code></pre><h3 id="fetching-number-of-tokens-locked-under-each-utility-at-a-future-timestamp">Fetching number of tokens locked under each utility at a future timestamp</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev Returns tokens locked for a specified address for a
  *      specified reason at a specific time
  *
  * @param _of The address whose tokens are locked
  * @param _reason The reason to query the lock tokens for
  * @param _time The timestamp to query the lock tokens for
  */
  function tokensLockedAtTime(address _of, bytes32 _reason, uint256 _time) public view returns (uint256 amount)
</span></code></pre><h3 id="fetching-number-of-tokens-held-by-an-address">Fetching number of tokens held by an address</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev @dev Returns total tokens held by an address (locked + transferable)
  * @param _of The address to query the total balance of
  */
function totalBalanceOf(address _of)  view returns (uint256 amount)
</span></code></pre><h3 id="extending-lock-period">Extending lock period</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev Extends lock for a specified reason and time
  * @param _reason The reason to lock tokens
  * @param _time Lock extension time in seconds
  */
  function extendLock(bytes32 _reason, uint256 _time) public returns (bool)
</span></code></pre><h3 id="increasing-number-of-tokens-locked">Increasing number of tokens locked</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev Increase number of tokens locked for a specified reason
  * @param _reason The reason to lock tokens
  * @param _amount Number of tokens to be increased
  */
  function increaseLockAmount(bytes32 _reason, uint256 _amount) public returns (bool)
</span></code></pre><h3 id="fetching-number-of-unlockable-tokens-under-each-utility">Fetching number of unlockable tokens under each utility</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev Returns unlockable tokens for a specified address for a specified reason
  * @param _of The address to query the the unlockable token count of
  * @param _reason The reason to query the unlockable tokens for
  */
  function tokensUnlockable(address _of, bytes32 _reason) public view returns (uint256 amount)
</span></code></pre><h3 id="fetching-number-of-unlockable-tokens">Fetching number of unlockable tokens</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev Gets the unlockable tokens of a specified address
  * @param _of The address to query the the unlockable token count of
  */
  function getUnlockableTokens(address _of) public view returns (uint256 unlockableTokens)
</span></code></pre><h3 id="unlocking-tokens">Unlocking tokens</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">/**
  * @dev Unlocks the unlockable tokens of a specified address
  * @param _of Address of user, claiming back unlockable tokens
  */
  function unlock(address _of) public returns (uint256 unlockableTokens)
</span></code></pre><h3 id="lock-event-recorded-in-the-token-contract">Lock event recorded in the token contract</h3>
<p><code>event Locked(address indexed _of, uint256 indexed _reason, uint256 _amount, uint256 _validity)</code></p>
<h3 id="unlock-event-recorded-in-the-token-contract">Unlock event recorded in the token contract</h3>
<p><code>event Unlocked(address indexed _of, uint256 indexed _reason, uint256 _amount)</code></p>
<h2 id="test-cases">Test Cases</h2>
<p>Test cases are available at <a href="https://github.com/nitika-goel/lockable-token">https://github.com/nitika-goel/lockable-token</a>.</p>
<h2 id="implementation">Implementation</h2>
<ul>
<li>Complete implementation available at https://github.com/nitika-goel/lockable-token</li>
<li><a href="https://govblocks.io">GovBlocks</a> Project specific implementation available at https://github.com/somish/govblocks-protocol/blob/Locking/contracts/GBTStandardToken.sol</li>
</ul>
<h2 id="copyright">Copyright</h2>
<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>



            </div>
        </main>


        <footer class="site-footer h-card">
            <div class="wrapper">
                <h2 class="footer-heading">Ethereum Improvement Proposals</h2>
                <div class="footer-col-wrapper">
                    <div class="footer-col footer-col-1">
                        <ul class="contact-list">
                            <li class="p-name">
                                
                                GitHub User
                                
                            </li>
                            <li>
                                <a class="u-email" href="mailto:your-email@domain.com">
                                  your-email@domain.com
                                </a>
                              </li>
                            </ul>
                    </div>
                    <div class="footer-col footer-col-3">
                        <p>Description</p>
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>
